<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>AsTechs WebUI</title>
  <script src='https://cdn.plot.ly/plotly-latest.min.js'></script>
  <link rel="stylesheet" href="/css/basic.css">
</head>

<body>
  <div id='navbar'>
		<ul>
			<li><a href="index.html">Home</a></li>
			<li><a href="about.html">About</a></li>
		</ul>
	</div>
	
  <div style='text-align: center'>
    <h1 style = "font-size:48px">AsTechs WebUI</h1>
    <img src="/img/astechs.png"  width="256" alt="AsTechs Logo">    
    <p>Welcome to the WebUI. Here you can view the status of the current devices in the network!</p>
    
    <hr size="1px" width="90%" color="black"> 
  </div>
  
  <div style='text-align: center'>
    <h2>Device Overview</h2>
    
    <div class="row">
      <div class="column">
        <h2>Remote</h2>
        <p>RCS1</p>
        <p>Custom PCB running Thread, the remote control for the system!</p>
      </div>
      <div class="column">
        <h2>Node #1</h2>
        <p>NCS1</p>
        <img id='n1img_off' src="/img/node_off.png" width='50' alt="concept outlet">
        <img id='n1img_on'  src="/img/node_on.png"  width='50' alt="concept outlet" style="display: none;">
        <p>Custom PCB running Thread controlling power outlet!</p>
      </div>
      <div class="column">
        <h2>Node #2</h2>
        <p>NTB1</p>
        <img id='n2img_off' src="/img/node_off.png" width='50' alt="concept outlet">
        <img id='n2img_on'  src="/img/node_on.png"  width='50' alt="concept outlet" style="display: none;">
        <p>Thunderboard Sense 2 running Thread pretending to be a power outlet!</p>
      </div>
      <div class="column">
        <h2>Node #3</h2>
        <p>NTB2</p>
        <img id='n3img_off' src="/img/node_off.png" width='50' alt="concept outlet">
        <img id='n3img_on'  src="/img/node_on.png"  width='50' alt="concept outlet" style="display: none;">
        <p>Thunderboard Sense 2 running Thread pretending to be a power outlet!</p>
      </div>
    </div>
    
  </div>
    <!-- <button id='btn0' type='button'>BRDA BTN0</button>
      document.getElementById("btn0").style.background='#aa0000';
      document.getElementById("btn0").style.background='#00aa00'; -->
      <!-- <button id='btn' onclick="btnClick()">Click me</button>  -->
      
      <p>Last Received Thread Message: <span id='lastmsg'></span></p>
      <div id='livePlot1'></div>
      
      <!-- <script src='/js/powerPlot.js'></script> -->
      <!-- <script src='/js/threadParse.js'></script> -->
      
      <script>
        var node1_on = false;
  var node2_on = false;
  var node3_on = false;

  function toggleNodeImage(divOn, divOff)
  {
    var temp = document.getElementById(divOff).style.display;
    document.getElementById(divOff).style.display = document.getElementById(divOn).style.display;
    document.getElementById(divOn ).style.display = temp;
  }

  function turnNodeOn(num)
  {
    switch(num)
    {
      case 1:
        if (!node1_on)
        {
          node1_on = true;
          toggleNodeImage('n1img_off', 'n1img_on');
        }
        break;
      case 2:
        if (!node2_on)
        {
          node2_on = true;
          toggleNodeImage('n2img_off', 'n2img_on');
        }
        break;
      case 3:
        if (!node3_on)
        {
          node3_on = true;
          toggleNodeImage('n3img_off', 'n3img_on');
        }
        break;
    }
  }

  function turnNodeOff(num)
  {
    switch(num)
    {
      case 1:
        if (node1_on)
        {
          node1_on = false;
          toggleNodeImage('n1img_off', 'n1img_on');
        }
        break;
      case 2:
        if (node2_on)
        {
          node2_on = false;
          toggleNodeImage('n2img_off', 'n2img_on');
        }
        break;
      case 3:
        if (node3_on)
        {
          node3_on = false;
          toggleNodeImage('n3img_off', 'n3img_on');
        }
        break;
    }
  }

  function updateNodeState(num, state)
  {
    if (state)
      turnNodeOn(num);
    else
      turnNodeOff(num);
  }
</script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.0.0/socket.io.js"></script>
<script>
  var socket = io(); //load socket.io-client and connect to the host that serves the page
  
  // function btnClick() 
  // {
  //     socket.emit('updateReq');
  // };

  socket.on('threadMsg', function(msg) 
  {
    document.getElementById('lastmsg').innerHTML = msg;

    if (msg == 'REMT1 NODE1 ON')
      turnNodeOn(1);
    else if (msg == 'REMT1 NODE1 OFF')
      turnNodeOff(1);
    else if (msg == 'REMT1 NODE1 TOG')
      updateNodeState(1, !node1_on);
    else if (msg == 'REMT1 NODE2 TOG')
      updateNodeState(2, !node2_on);
  });

  // socket.on('updateResStatus', function(n1, n2, n3) 
  // {
  //   updateNodeState(1, n1);
  //   updateNodeState(2, n2);
  //   updateNodeState(3, n3);
  //   document.getElementById('lastmsg').innerHTML = count;
  // });
</script>

</body>
</html>
