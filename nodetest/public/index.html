<!DOCTYPE html>
<html>
<head>
  <title>AsTechs WebUI</title>
  <script src='https://cdn.plot.ly/plotly-latest.min.js'></script>
  <style>
    * {
      box-sizing: border-box;
    }
    
    /* Create four equal columns that floats next to each other */
    .column {
      float: left;
      width: 25%;
      padding: 10px;
      text-align: center;
      /* height: 300px; */
      border: 2px solid black;
      background-color:#ddd;
    }
    
    /* Clear floats after the columns */
    .row:after {
      content: "";
      display: table;
      clear: both;
    }
    </style>
</head>

<body>
  <div style='text-align: center'>
    <h1>Astechs WebUI</h1>
    <img src="/img/astechs.png"  width="100" alt="AsTechs Logo">
    <p>Welcome to the WebUI. Here you can view the status of the current devices in the network!</p>
  </div>
  
  <div style='text-align: center'>
    <h2>Device Overview</h2>
  </div>

  <div class="row">
    <div class="column">
      <h2>Remote</h2>
      <p>RCS1</p>
      <p>Custom PCB running Thread, the remote control for the system!</p>
    </div>
    <div class="column">
      <h2>Node #1</h2>
      <p>NCS1</p>
      <img id='n1img_off' src="/img/node_off.png" width='50' alt="concept outlet">
      <img id='n1img_on'  src="/img/node_on.png"  width='50' alt="concept outlet" style="display: none;">
      <p>Custom PCB running Thread controlling power outlet!</p>
      <div id='livePlot1'></div>
    </div>
    <div class="column">
      <h2>Node #2</h2>
      <p>NTB1</p>
      <img id='n2img_off' src="/img/node_off.png" width='50' alt="concept outlet">
      <img id='n2img_on'  src="/img/node_on.png"  width='50' alt="concept outlet" style="display: none;">
      <p>Thunderboard Sense 2 running Thread pretending to be a power outlet!</p>
    </div>
    <div class="column">
      <h2>Node #3</h2>
      <p>NTB2</p>
      <img id='n3img_off' src="/img/node_off.png" width='50' alt="concept outlet">
      <img id='n3img_on'  src="/img/node_on.png"  width='50' alt="concept outlet" style="display: none;">
      <p>Thunderboard Sense 2 running Thread pretending to be a power outlet!</p>
    </div>
  </div>

  <!-- <button id='btn0' type='button'>BRDA BTN0</button>
  document.getElementById("btn0").style.background='#aa0000';
  document.getElementById("btn0").style.background='#00aa00'; -->

  <p>Last Received Thread Message: <span id='lastmsg'></span></p>

<script>
  var trace1 = {
      x: [ 1,  2,  3,  4,  5,  6,  7,  8,  9, 10],
      y: [0, 750, 1500, 750, 0, -750, -1500, -750, 0, 750],
      type: 'scatter'
  };

  var data = [trace1];

  var layout = {
      title: 'Power Consumption',
      showlegend: false,
      paper_bgcolor: "rgba(0,0,0,0)",
      plot_bgcolor: '#ccc',
      margin: {
        l: 0,
        r: 0,
        b: 100,
        t: 100,
        pad: 4
      },
  };

  Plotly.newPlot('livePlot1', data, layout);
</script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.0.0/socket.io.js"></script> <!-- include socket.io client side script -->
<script>
  var socket = io(); //load socket.io-client and connect to the host that serves the page

  socket.on('serialrec', function (data) 
  {
    data = String(data);

    if (data.startsWith('RCS1'))
    {
      if (data.includes('NCS1'))
      {
        var temp = document.getElementById('n1img_off').style.display;
        document.getElementById('n1img_off').style.display = document.getElementById('n1img_on').style.display;
        document.getElementById('n1img_on' ).style.display = temp;
      }
      else if (data.includes('NTB1'))
      {
        var temp = document.getElementById('n2img_off').style.display;
        document.getElementById('n2img_off').style.display = document.getElementById('n2img_on').style.display;
        document.getElementById('n2img_on' ).style.display = temp;
      }
      else if (data.includes('NTB2'))
      {
        var temp = document.getElementById('n3img_off').style.display;
        document.getElementById('n3img_off').style.display = document.getElementById('n3img_on').style.display;
        document.getElementById('n3img_on' ).style.display = temp;
      }
    }

    document.getElementById('lastmsg').innerHTML = data;
  });

</script>

</body>
</html>
