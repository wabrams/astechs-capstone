<!DOCTYPE html>
<html>
<head>
  <title>AsTechs WebUI</title>
  <style>
    * {
      box-sizing: border-box;
    }
    
    /* Create four equal columns that floats next to each other */
    .column {
      float: left;
      width: 25%;
      padding: 10px;
      height: 300px; /* Should be removed. Only for demonstration */
    }
    
    /* Clear floats after the columns */
    .row:after {
      content: "";
      display: table;
      clear: both;
    }
    </style>
</head>

<body>
  <h1>Astechs Control Panel</h1>
  <img src="/img/astechs.png" alt="AsTechs Logo">
  <h2>Outlet Manager</h2>
  <!-- <img src="/img/node.png" alt="concept outlet"> -->
  <div class="row">
    <div class="column" style="background-color:#aaa;">
      <h2>Column 1</h2>
      <p>Some text..</p>
    </div>
    <div class="column" style="background-color:#bbb;">
      <h2>Column 2</h2>
      <p>Some text..</p>
    </div>
    <div class="column" style="background-color:#ccc;">
      <h2>Column 3</h2>
      <p>Some text..</p>
    </div>
    <div class="column" style="background-color:#ddd;">
      <h2>Column 4</h2>
      <p>Some text..</p>
    </div>
  </div>


  <p><label for="displayValue">Toggle Node: </label>
  <input type="checkbox" id="light"></p>

  <button id='btn0' type='button'>BRDA BTN0</button>

  <label for="displayValue">The most recent power reading0 is: </label>
  <input type="textbox" name="powerdisplay0"/>
  <p id='pd0'></p>

  <label for="displayValue">The most recent power reading1 is: </label>
  <input type="textbox" name="powerdisplay1"/>
  <p id='pd1'></p>

<script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.0.0/socket.io.js"></script> <!-- include socket.io client side script -->
<script>
  var socket = io(); //load socket.io-client and connect to the host that serves the page
  window.addEventListener("load", function(){ //when page loads
    var lightbox = document.getElementById("light");
    lightbox.addEventListener("change", function() { //add event listener for when checkbox changes
      socket.emit("light", Number(this.checked)); //send button status to server (as 1 or 0)
    });
  });

  // socket.on('button', function (data) { //get button event from client
  //   document.getElementsByName('powerdisplay0')[0].value = data; //display the dummy power on front end
  // });

  socket.on('serialrec', function (data) { //get button event from client
    data = String(data);
    if (data.startsWith('BRDA'))
    {
      if (data.startsWith('BRDA 77'))
        document.getElementById("btn0").style.background='#aa0000';
      else
        document.getElementById("btn0").style.background='#00aa00';
      document.getElementById('pd0').innerHTML = data;
    }
    else if (data.startsWith('BRDB'))
      document.getElementById('pd1').innerHTML = data;

    document.getElementsByName('powerdisplay0')[0].value = data; //display any serially received data
  });

</script>

</body>
</html>
